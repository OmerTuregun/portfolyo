@{
    Layout = null; // We'll use our own layout
    ViewData["Title"] = "My Experience";
}

<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - √ñmer Faruk T√ºreg√ºn</title>

    <!-- Favicon (Emoji) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üë®‚Äçüíª</text></svg>">

    <!-- Bootstrap & Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- Google Font (Inter) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">

    <!-- AOS (Animation) -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/6.6.6/css/flag-icon.min.css" />
    <!-- MAIN CSS STYLES -->
    <style>
        :root {
            --bg-dark: #0D1117;
            --bg-glass: rgba(30, 41, 59, 0.5); /* Semi-transparent glass */
            --border-glass: rgba(56, 68, 87, 0.5);
            --text-light: #E6EDF3;
            --text-muted: #8B949E;
            --primary-light: #90EE90; /* Pistachio Green */
            --text-on-accent: #0D1117; /* Dark text on green */
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-light);
            line-height: 1.7;
        }

        /* Navbar */
        .navbar {
            background-color: var(--bg-glass) !important;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--border-glass);
            border-radius: 1rem;
            margin: 1rem;
        }
            .navbar .nav-link {
                color: var(--text-muted);
                font-weight: 500;
                transition: all 0.2s ease-in-out;
            }
                .navbar .nav-link:hover,
                .navbar .nav-link.active {
                    color: var(--primary-light) !important;
                }
        .navbar-brand {
            font-weight: 700;
            color: var(--text-light);
        }

        /* General Title Styles */
        .display-5, .display-6 {
            color: var(--text-light);
        }

        /* Card Styles */
        .glass-card {
            background: var(--bg-glass);
            border: 1px solid var(--border-glass);
            border-radius: 1rem;
            transition: all 0.3s ease;
        }

        #page-header {
            padding: 2rem 0;
        }

        /*
         * ==== VERTICAL TIMELINE STYLES ====
         */
        .timeline-container {
            position: relative;
            padding: 2rem 0;
        }
            /* Center vertical line */
            .timeline-container::before {
                content: '';
                position: absolute;
                top: 0;
                left: 1.5rem; /* Icon center */
                height: 100%;
                width: 3px;
                background-color: var(--border-glass);
                border-radius: 3px;
            }

        .timeline-group-header {
            margin-top: 1rem;
            margin-bottom: 1.5rem;
            position: relative; /* Stay above the line */
        }
            .timeline-group-header h2 {
                background-color: var(--primary-light);
                color: var(--text-on-accent);
                font-weight: 700;
                font-size: 1.5rem;
                padding: 0.5rem 1rem;
                border-radius: 0.5rem;
                display: inline-block;
            }
        
        /* Each experience row */
        .timeline-item {
            position: relative;
            margin-bottom: 2rem;
            padding-left: 4rem; /* Space for icon */
        }

        /* Timeline icon (Briefcase or School) */
        .timeline-icon {
            position: absolute;
            left: 0;
            top: 0.1rem;
            width: 3rem;  /* Line center was at 1.5rem */
            height: 3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-glass);
            border: 2px solid var(--border-glass);
            border-radius: 50%;
            z-index: 10;
        }
            .timeline-icon i {
                font-size: 1.25rem;
                color: var(--primary-light); /* Green icon */
            }

        /* Actual content card */
        .timeline-card {
            background: var(--bg-glass);
            border: 1px solid var(--border-glass);
            border-radius: 1rem;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }
            .timeline-card:hover {
                transform: translateY(-5px);
                border-color: rgba(144, 238, 144, 0.4);
            }

        .timeline-date {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--primary-light); /* Green date */
            margin-bottom: 0.25rem;
        }
        .timeline-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-light);
            margin-bottom: 0.1rem;
        }
        .timeline-company {
            font-size: 1.1rem;
            color: var(--text-muted);
            font-weight: 500;
            margin-bottom: 0.75rem;
        }
        .timeline-description {
            color: var(--text-light);
            margin-bottom: 1rem;
        }
        
        /* Technology Tags */
        .timeline-tags {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
            .timeline-tags li {
                font-size: 0.85rem;
                font-weight: 500;
                background-color: rgba(144, 238, 144, 0.1);
                color: var(--primary-light);
                border: 1px solid rgba(144, 238, 144, 0.2);
                padding: 0.3rem 0.6rem;
                border-radius: 0.5rem;
            }

        /* Footer */
        .footer {
            border-top: 1px solid var(--border-glass);
            padding: 2rem 0;
            margin-top: 2rem;
            color: var(--text-muted);
        }

        .language-card {
            background: var(--bg-glass);
            border: 1px solid var(--border-glass);
            border-radius: 1rem;
            padding: 1.5rem;
            height: 100%;
        }
        .language-list {
            list-style: none;
            padding-left: 0;
            margin-bottom: 0;
            display: flex;      /* Side by side */
            flex-wrap: wrap;    /* WRAP TO NEXT LINE IF DOESN'T FIT (THIS IS THE SOLUTION) */
            gap: 1rem;          /* Space between */
        }

        .language-list-item {
            flex-grow: 1;         /* Grow as much as they can */
            flex-basis: 200px;    /* But have at least 200px space (If they don't fit, they'll wrap to next line) */
        }
            
        .language-list-item:last-child {
            margin-bottom: 0; 
        }

        .language-header {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        /* Fixed style for flag icon */
        .language-flag {
            font-size: 1.25rem; /* Flag size */
            margin-right: 0.75rem;
            border-radius: 50%;
            overflow: hidden;
            width: 20px; /* Fixed width */
            height: 20px; /* Fixed height */
            line-height: 20px; /* Vertical alignment */
        }
            .language-flag .flag-icon {
                width: 100%;
                height: 100%;
            }

        .language-info {
            flex-grow: 1;
        }
        .language-title {
            font-size: 1.1rem;
            color: var(--text-light);
            font-weight: 700;
        }
        .language-level {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-left: 0.5rem;
        }

        /* Progress Bar Styles */
        .language-progress-bar {
            width: 100%;
            height: 6px;
            background-color: var(--bg-glass); /* Bar background */
            border-radius: 3px;
            overflow: hidden;
        }
        .language-progress {
            height: 100%;
            background-color: var(--primary-light); /* Green fill */
            width: 0%; /* Start for animation */
            transition: width 1s ease-out 0.3s; /* Delayed animation */
        }

        /* FIX: Trigger animation when card appears (no need for AOS) */
        .language-card .language-progress {
            width: var(--progress-width, 0%);
        }

        /* Sertifika Kartƒ± Stilleri */
        .certificate-grid {
            display: grid;
            grid-template-columns: 1fr; /* Mobilde tek s√ºtun */
            gap: 1rem;
        }

        /* Desktop'ta (LG) 2 s√ºtunlu grid */
        @@media (min-width: 992px) {
            .certificate-grid {
                grid-template-columns: repeat(2, 1fr); /* 2 s√ºtun */
                gap: 1.5rem;
            }
        }

        .certificate-card {
            background: var(--bg-glass);
            border: 1px solid var(--border-glass);
            border-radius: 1rem;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            height: 100%; /* Grid'de e≈üit y√ºkseklik i√ßin */
        }

        .certificate-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-light);
            margin-bottom: 0.25rem;
        }
        .certificate-provider {
            font-size: 0.9rem;
            color: var(--primary-light); /* Ye≈üil */
            font-weight: 500;
        }
        .certificate-date {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 0.75rem;
        }
        .certificate-skills {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-top: auto; /* Linki dibe iterken bunu √ºstte tutar */
            padding-top: 1rem;
        }
        .certificate-link {
            display: inline-block;
            margin-top: 1rem;
            font-weight: 700;
            color: var(--primary-light);
            text-decoration: none;
            transition: all 0.3s ease;
        }
        .certificate-link:hover {
            color: #fff;
            transform: translateX(4px);
        }
    </style>
</head>
<body data-bs-theme="dark" class="bg-dark text-white">    
    <!-- ==== STICKY NAVBAR ==== -->
    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
            <a class="navbar-brand" asp-controller="Home" asp-action="Index">
                √ñmer Faruk T√úREG√úN
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" asp-controller="Home" asp-action="Index">Home</a></li>
                    <li class="nav-item">
                        <a class="nav-link" asp-controller="Home" asp-action="AboutMe">About Me</a>
                    </li>
                    <li class="nav-item"><a class="nav-link" asp-controller="Home" asp-action="Projects">Projects</a></li>
                    <li class="nav-item"><a class="nav-link active" aria-current="page" asp-controller="Home" asp-action="Experience">Experience</a></li>
                    <li class="nav-item"><a class="nav-link" asp-controller="Home" asp-action="Contact">Contact</a></li>
                </ul>
                <ul class="navbar-nav ms-2">
    <li class="nav-item">
        <!-- Bu 'Index.en' sayfasƒ±nda olduƒüu i√ßin asp-action="Index" yazar -->
        <a class="nav-link" asp-controller="Home" asp-action="Index" asp-route-lang="tr" style="font-weight: 700;">
            <i class="bi bi-translate me-1"></i> TR
        </a>
    </li>
</ul>
            </div>
        </div>
    </nav>
    
    <!-- ==== MAIN CONTENT ==== -->
    <main class="container mt-4">
        
        <!-- Page Header -->
        <section id="page-header" class="mb-4">
            <div class="row g-4 align-items-stretch">
                
                <!-- Left Column: Title -->
                <div class="col-lg-8" data-aos="fade-right">
                    <h1 class="display-5 fw-bold text-white mb-3">Experience & Education</h1>
                    <p class="lead text-white-50">
                        My professional career journey and academic background.
                    </p>
                </div>
                
                <!-- Right Column: Languages Card Will Come Here via JS -->
                <div class="col-lg-4 d-flex align-items-stretch" id="language-card-container" data-aos="fade-left" data-aos-delay="100">
                    <!-- Languages card will be loaded here via JS -->
                </div>

            </div>
        </section>
        
        <!-- Timeline -->
        <section class="timeline-container" id="experience-timeline-container">
            <!-- Experience and Education will be loaded here via JS -->
        </section>

    </main>

    <!-- ==== SERTƒ∞Fƒ∞KALAR B√ñL√úM√ú ==== -->
    <section id="certificates-section" class="py-5">
        
        <div class="timeline-group-header" data-aos="fade-right" style="padding-left: 4rem;">
            <h2 id="certificates-title">Certificates</h2> 
        </div>

        <!-- Sertifika Kartlarƒ± Buraya JS ile Gelecek -->
        <div class="certificate-grid" id="certificates-container">
            <!-- Y√ºkleniyor... (JS ile temizlenecek) -->
        </div>

    </section>

    <!-- ==== BUNU SAYFANIN EN ALTINA (</body> √ñNCESƒ∞NE) EKLE ==== -->

    <!-- ==== SERTƒ∞Fƒ∞KA G√ñR√úNT√úLEME MODALI (Gƒ∞ZLƒ∞) ==== -->
    <div class="modal fade" id="certificateModal" tabindex="-1" aria-labelledby="certificateModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-xl"> <!-- TAM EKRANA YAKIN (XL) -->
            <div class="modal-content" style="background-color: var(--bg-dark); border: 1px solid var(--border-glass);">
                
                <div class="modal-header border-0">
                    <!-- Ba≈ülƒ±k JS ile doldurulacak -->
                    <h5 class="modal-title text-white" id="certificateModalLabel">Certificate</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                
                <div class="modal-body text-center p-2">
                    <!-- Resim JS ile buraya eklenecek -->
                    <img src="" id="certificateModalImage" class="img-fluid" alt="Sertifika G√∂r√ºnt√ºs√º" style="max-height: 80vh;">
                </div>

            </div>
        </div>
    </div>
    
    <!-- ==== FOOTER ==== -->
    <footer class="footer">
        <div class="container text-center">
            <span class="text-muted">¬© @DateTime.Now.Year √ñmer Faruk T√ºreg√ºn. All rights reserved.</span>
        </div>
    </footer>
    
    <!-- Bootstrap & AOS Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <!-- MAIN SCRIPT (Fetch Data from JSON) -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Start animations
            AOS.init({
                duration: 600,
                once: true
            });
            
            // Fetch data and create HTML
            fetchExperienceData();
            fetchCertificates();

            const certificateModal = document.getElementById('certificateModal');
            if (certificateModal) {
                certificateModal.addEventListener('show.bs.modal', function (event) {
                    // Tƒ±klanan link (buton)
                    const button = event.relatedTarget;
                    
                    // Veriyi linkin data-* √∂zelliklerinden √ßek
                    const imgSrc = button.getAttribute('data-img-src');
                    const title = button.getAttribute('data-title');

                    // Modal'ƒ±n i√ßindeki elemanlarƒ± bul ve g√ºncelle
                    const modalTitle = certificateModal.querySelector('#certificateModalLabel');
                    const modalImage = certificateModal.querySelector('#certificateModalImage');
                    
                    modalTitle.textContent = title;
                    modalImage.src = imgSrc;
                });
            }
        });

        // ==== DELETE OLD "fetchExperienceData" FUNCTION AND ADD THIS ====

        async function fetchExperienceData() {
            try {
                const response = await fetch('/data-en/experience.json');
                if (!response.ok) throw new Error('Data could not be retrieved');
                
                const data = await response.json();
                const timelineContainer = document.getElementById('experience-timeline-container');
                const languageContainer = document.getElementById('language-card-container');
                
                timelineContainer.innerHTML = ''; // Clear timeline
                languageContainer.innerHTML = ''; // Clear languages card

                // Process each group in JSON (Education, Work, Internship, Languages)
                data.forEach(group => {
                    
                    // ---- NEW LOGIC HERE ----
                    // If group is "Languages", put it in TOP RIGHT COLUMN (languageContainer)
                    if (group.type === 'Diller' || group.type === 'Languages') {
                        const items = group.items;
                        languageContainer.innerHTML = createLanguageCardHTML(items);
                    } 
                    // Otherwise (Education, Work, Internship), put it in MAIN TIMELINE (timelineContainer)
                    else {
                        // Group Header (e.g., "Work Experience")
                        timelineContainer.innerHTML += `
                            <div class="timeline-group-header" data-aos="fade-right">
                                <h2>${group.type}</h2>
                            </div>
                        `;
                        
                        // Process items in group
                        const items = group.experience || group.items;
                        items.forEach((item, index) => {
                            const iconClass = group.type === 'Eƒüitim' || group.type === 'Education' ? 'bi-mortarboard-fill' : 'bi-briefcase-fill';
                            timelineContainer.innerHTML += createTimelineItemHTML(item, iconClass, index);
                        });
                    }
                    // ---- /NEW LOGIC END ----
                });

                setTimeout(() => { AOS.refresh(); }, 100);

            } catch (error) {
                console.error('Error loading experience data:', error);
                document.getElementById('experience-timeline-container').innerHTML = '<p class="text-danger text-center">An error occurred while loading experiences.</p>';
            }
        }

        function createLanguageCardHTML(items) {
            
            const listItemsHTML = items.map(item => `
                <li class="language-list-item">
                    <div class="language-header">
                        <!-- Flag (FIXED HTML) -->
                        <span class="language-flag">
                            <span class="flag-icon flag-icon-${item.flagCode}"></span>
                        </span>
                        <!-- Title and Level -->
                        <div class="language-info">
                            <span class="language-title">${item.title}</span>
                            <span class="language-level">${item.description}</span>
                        </div>
                    </div>
                    <!-- Progress Bar -->
                    <div class="language-progress-bar">
                        <div class="language-progress" style="--progress-width: ${item.percentage}%;"></div>
                    </div>
                </li>
            `).join('');

            return `
            <div class="language-card">
                <h5 class="text-white fw-bold mb-3">Languages</h5>
                <ul class="language-list">
                    ${listItemsHTML}
                </ul>
            </div>
            `;
        }

        // 2. Function to create Timeline Card (UNCHANGED)
        function createTimelineItemHTML(item, iconClass, index) {
            let tagsHTML = '';
            if (item.tags && item.tags.length > 0) {
                tagsHTML = `
                    <ul class="timeline-tags">
                        ${item.tags.map(tag => `<li>${tag}</li>`).join('')}
                    </ul>
                `;
            }
            return `
            <div class="timeline-item" data-aos="fade-up" data-aos-delay="${index * 100}">
                <div class="timeline-icon">
                    <i class="bi ${iconClass}"></i>
                </div>
                <div class="timeline-card">
                    <div class="timeline-date">${item.dateRange}</div>
                    <h4 class="timeline-title">${item.title}</h4>
                    <h5 class="timeline-company">${item.company}</h5>
                    <p class="timeline-description">${item.description}</p>
                    ${tagsHTML}
                </div>
            </div>
            `;
        }

        async function fetchCertificates() {
            // Dil (lang) parametresine g√∂re doƒüru JSON'u se√ß
            const lang = document.documentElement.lang || 'tr';
            const jsonPath = lang === 'en' ? '/data-en/certificates.json' : '/data/certificates.json';
            
            // TR veya EN ba≈ülƒ±k
            const titleText = lang === 'en' ? 'Certificates' : 'Sertifikalar';
            document.getElementById('certificates-title').innerText = titleText;
            
            try {
                const response = await fetch(jsonPath);
                if (!response.ok) throw new Error('Sertifika verisi alƒ±namadƒ±');
                
                const data = await response.json();
                const container = document.getElementById('certificates-container');
                container.innerHTML = ''; // Temizle

                data.forEach((cert, index) => {
                    container.innerHTML += createCertificateCardHTML(cert, index, lang);
                });

                AOS.refresh();

            } catch (error) {
                console.error('Sertifikalar y√ºklenirken hata olu≈ütu:', error);
                container.innerHTML = '<p class="text-danger text-center">Sertifikalar y√ºklenirken bir hata olu≈ütu.</p>';
            }
        }

        function createCertificateCardHTML(cert, index, lang) {
            const linkText = lang === 'en' ? 'View Certificate' : 'Sertifikayƒ± G√∂r√ºnt√ºle';
            const skillsTitle = lang === 'en' ? 'Skills' : 'Yetenekler';
            
            // Resim yolunu d√ºzelt
            let correctedImgUrl = cert.imageUrl.startsWith('~/') ? cert.imageUrl.substring(1) : cert.imageUrl;

            return `
            <div class="certificate-card" data-aos="fade-up" data-aos-delay="${(index % 2) * 100}">
                <div class="certificate-provider">${cert.provider}</div>
                <h4 class="certificate-title">${cert.title}</h4>
                <div class="certificate-date">${cert.date}</div>
                
                <p class="certificate-skills mb-0">
                    <strong>${skillsTitle}:</strong> ${cert.skills.join(' ¬∑ ')}
                </p>

                <!-- 
                    DEƒûƒ∞≈ûƒ∞KLƒ∞K BURADA:
                    Bu artƒ±k bir 'a' linki deƒüil, modal'ƒ± a√ßan bir 'button' linki.
                    'data-bs-toggle' ve 'data-bs-target' eklendi.
                    'data-img-src' ve 'data-title' ile modalƒ± besleyeceƒüiz.
                -->
                <a href="#" class="certificate-link"
                data-bs-toggle="modal"
                data-bs-target="#certificateModal"
                data-img-src="${correctedImgUrl}"
                data-title="${cert.title}">
                    ${linkText} <i class="bi bi-arrow-right-short"></i>
                </a>
            </div>
            `;
        }

    </script>
    
</body>
</html>